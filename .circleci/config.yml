version: 2.1

parameters:
  type:
    type: enum
    enum: ["ci", "build", "default"]
    default: "default"
orbs:
  meli: mercadolibre/android@volatile
default-workflow: &defaultWorkflow
  filters:
    branches:
      ignore:
        - master
        - /release\/.*$/
        - /v\/.*$/
workflows:
  ci:
    jobs:
      - meli/assemble:
          <<: *defaultWorkflow
          machine_size: xlarge
      - meli/check:
          <<: *defaultWorkflow
          machine_size: xlarge
  build:
    when:
      equal: [build, << pipeline.parameters.type >>] 
    jobs:
      - meli/build
